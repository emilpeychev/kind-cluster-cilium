{
  "SchemaVersion": 2,
  "Trivy": {
    "Version": "0.69.1"
  },
  "ReportID": "019c708c-fc4e-7ec1-83bd-1879530b534b",
  "CreatedAt": "2026-02-18T11:40:13.774970977Z",
  "ArtifactID": "sha256:2fedc419ab88177385d7df370802e6857caa6f1ad4f2a6c9e460ade8224bb186",
  "ArtifactName": ".",
  "ArtifactType": "repository",
  "Metadata": {
    "RepoURL": "git@github.com:emilpeychev/kind-cluster-cilium.git",
    "Branch": "master",
    "Commit": "419f8d1cbdf2e151d30690b5f7edfae2bef7e65f",
    "CommitMsg": "red bg (#69)\n\nCo-authored-by: eepeychev \u003ceepeychev@yettel.bg\u003e",
    "Author": "emilpeychev \u003c69958740+emilpeychev@users.noreply.github.com\u003e",
    "Committer": "GitHub \u003cnoreply@github.com\u003e"
  },
  "Results": [
    {
      "Target": "Argo-Workflows/argo-server-config.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 33,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'argo-server' of Deployment 'argo-server' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 12,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 12,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - name: argo-server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: argo-server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "            - server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - --secure=false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --secure=false",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - --auth-mode=server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --auth-mode=server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          readinessProbe:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadinessProbe\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            httpGet:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mhttpGet\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "              path: /",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mpath\u001b[0m: /",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container argo-server in argo namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 12,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 12,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - name: argo-server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: argo-server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "            - server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - --secure=false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --secure=false",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - --auth-mode=server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --auth-mode=server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          readinessProbe:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadinessProbe\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "            httpGet:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mhttpGet\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "              path: /",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mpath\u001b[0m: /",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment argo-server in argo namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 10,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 10,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        - name: argo-server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: argo-server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "          args:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33margs\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "            - server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "            - --secure=false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --secure=false",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "            - --auth-mode=server",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - --auth-mode=server",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          readinessProbe:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mreadinessProbe\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 19,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "Argo-Workflows/workflows-httproute.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-Events/github-sensor-debug.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-Events/github-webhook-eventsource.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-Events/github-webhook-secret.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-Events/jetstream-eventbus.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-Events/rbac.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-Events/serviceaccount.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-Events/webhook-httproute.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-demo-apps/api/deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 33,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'httpbin' of Deployment 'httpbin' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 17,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 17,
                  "Content": "      - name: httpbin",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: httpbin",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        image: kennethreitz/httpbin:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: kennethreitz/httpbin:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container httpbin in httpbin namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 17,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 17,
                  "Content": "      - name: httpbin",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: httpbin",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        image: kennethreitz/httpbin:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: kennethreitz/httpbin:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment httpbin in httpbin namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 15,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 15,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "      - name: httpbin",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: httpbin",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        image: kennethreitz/httpbin:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: kennethreitz/httpbin:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80\u001b[0m",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "ArgoCD-demo-apps/api/httproute.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-demo-apps/api/service.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-demo-apps/applicationsets/api-applicationsets.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-demo-apps/applicationsets/application-sets.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-demo-apps/apps/deployment.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 33,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'app' of Deployment 'demo-app1' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 24,
            "EndLine": 35,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "        - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          image: harbor.local/library/demo-app:20260218-113501",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: harbor.local/library/demo-app:20260218-113501",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          imagePullPolicy: Always",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimagePullPolicy\u001b[0m: Always",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "          resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "            requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "              cpu: 100m",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcpu\u001b[0m: 100m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "              memory: 128Mi",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: 128Mi",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 33,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container demo-app1 in demo-apps namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 24,
            "EndLine": 35,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "        - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          image: harbor.local/library/demo-app:20260218-113501",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: harbor.local/library/demo-app:20260218-113501",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          imagePullPolicy: Always",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimagePullPolicy\u001b[0m: Always",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "          resources:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mresources\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "            requests:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33mrequests\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "              cpu: 100m",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mcpu\u001b[0m: 100m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "              memory: 128Mi",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "              \u001b[38;5;33mmemory\u001b[0m: 128Mi",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 33,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "deployment demo-app1 in demo-apps namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 20,
            "EndLine": 35,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "      imagePullSecrets:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mimagePullSecrets\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - name: harbor-regcred",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: harbor-regcred",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "        - name: app",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: app",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          image: harbor.local/library/demo-app:20260218-113501",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimage\u001b[0m: harbor.local/library/demo-app:20260218-113501",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "          imagePullPolicy: Always",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mimagePullPolicy\u001b[0m: Always",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "          ports:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mports\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "            - containerPort: 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            - \u001b[38;5;33mcontainerPort\u001b[0m: \u001b[38;5;37m80",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "ArgoCD-demo-apps/apps/httproute.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-demo-apps/apps/service.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-demo-apps/projects/api-project.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD-demo-apps/projects/application-sets-projects.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD/configmap-cm.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD/httproute.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "ArgoCD/rbac-cm.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Harbor/harbor-ca-installer.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 30,
        "Failures": 5
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0009",
          "Title": "Access to host network",
          "Description": "Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.",
          "Message": "DaemonSet 'harbor-ca-installer' should not set 'spec.template.spec.hostNetwork' to true",
          "Namespace": "builtin.kubernetes.KSV009",
          "Query": "data.builtin.kubernetes.KSV009.deny",
          "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0009",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0009"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 6,
            "EndLine": 59,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  selector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mselector\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    matchLabels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      name: harbor-ca-installer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mname\u001b[0m: harbor-ca-installer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    metadata:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "      labels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        name: harbor-ca-installer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mname\u001b[0m: harbor-ca-installer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'ca-installer' of DaemonSet 'harbor-ca-installer' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 17,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 17,
                  "Content": "      - name: ca-installer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: ca-installer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        image: alpine:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        - sh",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - sh",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          echo \"Installing CA certificate...\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Installing CA certificate...\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          cp /ca/ca.crt /host/usr/local/share/ca-certificates/harbor-ca.crt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cp /ca/ca.crt /host/usr/local/share/ca-certificates/harbor-ca.crt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          chroot /host update-ca-certificates",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          chroot /host update-ca-certificates",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0017",
          "Title": "Privileged",
          "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
          "Message": "Container 'ca-installer' of DaemonSet 'harbor-ca-installer' should set 'securityContext.privileged' to false",
          "Namespace": "builtin.kubernetes.KSV017",
          "Query": "data.builtin.kubernetes.KSV017.deny",
          "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0017",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
            "https://avd.aquasec.com/misconfig/ksv-0017"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 17,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 17,
                  "Content": "      - name: ca-installer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: ca-installer",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        image: alpine:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        - sh",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - sh",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "          echo \"Installing CA certificate...\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          echo \"Installing CA certificate...\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "          cp /ca/ca.crt /host/usr/local/share/ca-certificates/harbor-ca.crt",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          cp /ca/ca.crt /host/usr/local/share/ca-certificates/harbor-ca.crt",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "          chroot /host update-ca-certificates",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          chroot /host update-ca-certificates",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "daemonset harbor-ca-installer in kube-system namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 14,
            "EndLine": 59,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "      hostNetwork: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mhostNetwork\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "      - name: ca-installer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: ca-installer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "        image: alpine:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: alpine:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "        - sh",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - sh",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0121",
          "Title": "Kubernetes resource with disallowed volumes mounted",
          "Description": "HostPath present many security risks and as a security practice it is better to avoid critical host paths mounts.",
          "Message": "daemonset harbor-ca-installer in kube-system namespace shouldn't have volumes set to {\"/\"}",
          "Namespace": "builtin.kubernetes.KSV121",
          "Query": "data.builtin.kubernetes.KSV121.deny",
          "Resolution": "Do not Set 'spec.volumes[*].hostPath.path' to any of the disallowed volumes.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0121",
          "References": [
            "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
            "https://avd.aquasec.com/misconfig/ksv-0121"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 6,
            "EndLine": 59,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  selector:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mselector\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    matchLabels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmatchLabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      name: harbor-ca-installer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mname\u001b[0m: harbor-ca-installer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  template:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mtemplate\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    metadata:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mmetadata\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "      labels:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mlabels\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        name: harbor-ca-installer",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mname\u001b[0m: harbor-ca-installer",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "Harbor/harbor-httproute.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Kyverno/application.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Kyverno/policy-exceptions.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Kyverno/project.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Kyverno/verify-image-policy.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton-Pipelines/configs/cosign-keygen-job.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 33,
        "Failures": 7
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'check-secret' of Job 'generate-cosign-key' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 12,
            "EndLine": 28,
            "Code": {
              "Lines": [
                {
                  "Number": 12,
                  "Content": "      - name: check-secret",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: check-secret",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        image: bitnami/kubectl:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: bitnami/kubectl:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          # Check if secret already exists",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          # Check if secret already exists",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "          if kubectl get secret cosign-key -n tekton-builds 2\u003e/dev/null; then",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          if kubectl get secret cosign-key -n tekton-builds 2\u003e/dev/null; then",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "            echo \"Cosign key secret already exists, using existing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            echo \"Cosign key secret already exists, using existing\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'create-secret' of Job 'generate-cosign-key' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 52,
            "EndLine": 74,
            "Code": {
              "Lines": [
                {
                  "Number": 52,
                  "Content": "      - name: create-secret",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: create-secret",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        image: bitnami/kubectl:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: bitnami/kubectl:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          if [ -f /shared/skip-generation ]; then",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          if [ -f /shared/skip-generation ]; then",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "            echo \"Secret already exists, job complete\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            echo \"Secret already exists, job complete\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "            exit 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            exit 0",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 61,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'generate-key' of Job 'generate-cosign-key' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 50,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: generate-key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: generate-key",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: gcr.io/projectsigstore/cosign:v2.2.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: gcr.io/projectsigstore/cosign:v2.2.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - name: COSIGN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: COSIGN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          value: \"\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        workingDir: /keys",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mworkingDir\u001b[0m: /keys",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        - sh",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - sh",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container generate-cosign-key in tekton-builds namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 52,
            "EndLine": 74,
            "Code": {
              "Lines": [
                {
                  "Number": 52,
                  "Content": "      - name: create-secret",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: create-secret",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "        image: bitnami/kubectl:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: bitnami/kubectl:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "        - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "          if [ -f /shared/skip-generation ]; then",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          if [ -f /shared/skip-generation ]; then",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "            echo \"Secret already exists, job complete\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            echo \"Secret already exists, job complete\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "            exit 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            exit 0",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 61,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container generate-cosign-key in tekton-builds namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 29,
            "EndLine": 50,
            "Code": {
              "Lines": [
                {
                  "Number": 29,
                  "Content": "      - name: generate-key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: generate-key",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "        image: gcr.io/projectsigstore/cosign:v2.2.0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: gcr.io/projectsigstore/cosign:v2.2.0",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "        env:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33menv\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "        - name: COSIGN_PASSWORD",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mname\u001b[0m: COSIGN_PASSWORD",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "          value: \"\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mvalue\u001b[0m: \u001b[38;5;37m\"\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "        workingDir: /keys",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m        \u001b[38;5;33mworkingDir\u001b[0m: /keys",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        - sh",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - sh",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 38,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container generate-cosign-key in tekton-builds namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 12,
            "EndLine": 28,
            "Code": {
              "Lines": [
                {
                  "Number": 12,
                  "Content": "      - name: check-secret",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: check-secret",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        image: bitnami/kubectl:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: bitnami/kubectl:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "          # Check if secret already exists",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;37m          # Check if secret already exists",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "          if kubectl get secret cosign-key -n tekton-builds 2\u003e/dev/null; then",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          if kubectl get secret cosign-key -n tekton-builds 2\u003e/dev/null; then",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "            echo \"Cosign key secret already exists, using existing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            echo \"Cosign key secret already exists, using existing\"",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "job generate-cosign-key in tekton-builds namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 8,
            "EndLine": 79,
            "Code": {
              "Lines": [
                {
                  "Number": 8,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      serviceAccountName: tekton-build-sa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mserviceAccountName\u001b[0m: tekton-build-sa",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "      restartPolicy: OnFailure",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mrestartPolicy\u001b[0m: OnFailure",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "      initContainers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33minitContainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "      - name: check-secret",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: check-secret",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        image: bitnami/kubectl:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: bitnami/kubectl:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 17,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "Tekton-Pipelines/configs/github-deploy-key-secret.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton-Pipelines/configs/harbor-ca-configmap.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 33,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0014",
          "Title": "Root file system is not read-only",
          "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
          "Message": "Container 'copy-configmap' of Job 'copy-harbor-ca-cert' should set 'securityContext.readOnlyRootFilesystem' to true",
          "Namespace": "builtin.kubernetes.KSV014",
          "Query": "data.builtin.kubernetes.KSV014.deny",
          "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0014",
          "References": [
            "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
            "https://avd.aquasec.com/misconfig/ksv-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 12,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 12,
                  "Content": "      - name: copy-configmap",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: copy-configmap",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        image: bitnami/kubectl:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: bitnami/kubectl:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "container copy-harbor-ca-cert in tekton-builds namespace is using the default security context",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 12,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 12,
                  "Content": "      - name: copy-configmap",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: copy-configmap",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        image: bitnami/kubectl:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: bitnami/kubectl:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Kubernetes Security Check",
          "ID": "KSV-0118",
          "Title": "Default security context configured",
          "Description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
          "Message": "job copy-harbor-ca-cert in tekton-builds namespace is using the default security context, which allows root privileges",
          "Namespace": "builtin.kubernetes.KSV118",
          "Query": "data.builtin.kubernetes.KSV118.deny",
          "Resolution": "To enhance security, it is strongly recommended not to rely on the default security context. Instead, it is advisable to explicitly define the required security parameters (such as runAsNonRoot, capabilities, readOnlyRootFilesystem, etc.) within the security context.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv-0118",
          "References": [
            "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
            "https://avd.aquasec.com/misconfig/ksv-0118"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Kubernetes",
            "Service": "general",
            "StartLine": 8,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 8,
                  "Content": "    spec:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mspec\u001b[0m:",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      serviceAccountName: tekton-build-sa",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mserviceAccountName\u001b[0m: tekton-build-sa",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "      restartPolicy: OnFailure",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mrestartPolicy\u001b[0m: OnFailure",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "      containers:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mcontainers\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "      - name: copy-configmap",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      - \u001b[38;5;33mname\u001b[0m: copy-configmap",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "        image: bitnami/kubectl:latest",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mimage\u001b[0m: bitnami/kubectl:latest",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "        command:",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;33mcommand\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "        - /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - /bin/bash",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "        - -c",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - -c",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "        - |",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - |",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "Tekton-Pipelines/configs/tekton-rbac.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton-Pipelines/configs/tekton-sa-builds.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton-Pipelines/configs/tekton-sa.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton-Pipelines/tekton-pipeline-run.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton-Pipelines/tekton-pipeline.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton-Pipelines/tekton-task-1-clone-repo.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton-Pipelines/tekton-task-2-build-push.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton-Pipelines/tekton-task-3-trivy-image-scan.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton-Pipelines/tekton-task-4-cosign.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton-Pipelines/tekton-task-5-update-tag.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "Tekton/tekton-dashboard-httproute.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "demo-app/Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 19,
        "Failures": 1
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS-0002",
          "Title": "Image user should not be 'root'",
          "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
          "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
          "Namespace": "builtin.dockerfile.DS002",
          "Query": "data.builtin.dockerfile.DS002.deny",
          "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds-0002",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds-0002"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general"
          }
        }
      ]
    },
    {
      "Target": "gateway.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "metalLB/metallb-config.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "metrics-server/application.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "metrics-server/project.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "observability-tools/kiali/addrepo-argcd.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "observability-tools/kiali/application.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "observability-tools/kiali/httproute.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "observability-tools/kiali/project.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "observability-tools/prometheus/application.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "observability-tools/prometheus/grafana-application.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "observability-tools/prometheus/grafana-httproute.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "observability-tools/prometheus/project.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    },
    {
      "Target": "observability-tools/prometheus/prometheus-httproute.yaml",
      "Class": "config",
      "Type": "kubernetes",
      "MisconfSummary": {
        "Successes": 35,
        "Failures": 0
      }
    }
  ]
}
